# 01 관계데이터 모델의 개념
관계데이터베이스는 일반적으로 하나의 개체에 대한 데이터를 릴레이션 하나에 담아서 데이터베이스에 저장한다.   
릴레이션에서 사용되는 용어를 알아보자.
## 속성 / 열 / 애트리튜트
- 릴레이션의 열. 데이터의 각각의 속성을 담는다.
## 튜플 / 행
- 릴레이션의 행. 각 투플은 릴레이션의 인스턴스이다.
## 도메인 
- 속성 하나가 가질 수 있는 모든 값의 집합을 해당 속성의 도매인 이라고 한다.
- 예를들어 등급 : 실버, 골드, 브론즈
- 이런식으로 도메인을 설정하면 시스템이 적합성을 판단하는 기준이 되고, 항상 올바른 값을 유지 가능하다는 장점이있다.
- 근데 고객아이디 이름 나이 등은 도메인을 정확히 정의하기 어렵다.
- 따라서 도메인은 일반적으로 속성의 특성을 고려한 데이터타입으로 정의한다.
- 예를들어 CHAR(20), INT
- 데이터 타입을 도메인이라 생각하자.
- 추가로 도메인을 설정하면 서로 다른 속성이 도메인이 같은지 판단해 연산가능 결정 여부를 판단해준다.     
따라서 사용자가 잘못된 연산을 시도하는 것을 예방가능하다.
## 널값
- 값이 없음, 알 수 없는 상태
- 공백 , 0 와는 다르다!
## 차수
- 하나의 릴레이션의 속성 전체의 개수를 차수라고 한다.
- 모든 릴레이션은 최소 1이상의 차수를 유지해야한다.
- 릴레이션의 차수는 일반적으로 자주 변하지 않는다는 정적인 특성이 있다.
## 카디널리티
- 투플의 전체 개수(인스턴스의 개수)
- 릴레이션의 카디널리티는 일반적으로 자주 변한다는 동적인 특성이 있다.
## 릴레이션 스키마 / 릴레이션 내포 (정적)
- 릴레이션에 포함된 모든 속성의 이름을 정의하는 릴레이션의 논리적 구조이다.
- 릴레이션 이름(속성이름 1, 2..)
## 릴레이션 인스턴스 / 릴레이션 외연 / 릴레이션 (동적)
- 릴레이션인스턴스는 어느 한 시점에 릴레이션에 존재하는 투플들의 집합이다.
## 데이터베이스 스키마와 데이터베이스 인스턴스
- 데이터베이스는 릴레이션 여러개로 구성된다.
- 에를들어 : 고객릴레이션, 상품릴레이션, 주문릴레이션
---
## 릴레이션의 특성
### 투플의 유일성 : 하나의 릴레이션에는 동일한 튜플이 존재할 수 없다.
- 투플이 유일하게 구별되기 위한 속성을 키라고 한다.
### 투플의 무순서 : 하나의 릴레이션에서 투플사이의 순서는 무의미하다.
- 즉 두 투플의 순서가 바뀌어도 무관하다.
### 속성의 무순서 : 하나의 릴레이션에는 속성 사이의 순서가 무의미하다.
- 즉 두 속성의 순서가 바뀌어도 무관하다.
### 속성의 원자성 : 속성은 원자값만 사용가능 하다.
- 모든 속성은 더이상 분해할 수 없는 하나의 값, 즉 단일값(원자값)만 가질 수있다.
- 이는 관계 데이터 모델에서 복잡한 개념을 배제하고 릴레이션을 단순한 구조로 정의하고자 하는 특징이다.
---
## 키의 종류
### 슈퍼키( 유일성 )
- 슈퍼키는 유일성을 만족하는 속성 또는 속성들의 집합
### 후보키( 유일성 & 최소성 )
- 유일성을 만족하면서 최소한의 꼭 필요한 속성들로만 구성
### 기본키( 후보키 중 하나 )
- 후보키 중에서 데이터베이스의 사용환경을 고려하여 적합한 것을 기본키로 선택
-       1. 널값을 가질 수 없다.( 다른 투플과 비교가 안되므로 )
        2. 값이 자주 변경되는 후보키는 기본키로 적합하지 않다.( 적합여부를 계속 판단해야 하므로 )
        3. 단순한 후보키를 기본키로 선택한다. ( 컴퓨터 시스템도 단순 값 처리를 선호하므로 )
### 대체키( 선택되지 못한 후보키 )
### 외래키( 다른 릴레이션의 기본키 )
- 기본키를 그대로 참조하는 속성 또는 속성들의 집합
- 외래키는 릴레이션 사이의 관계를 올바르게 표현하기 위해 필요하다.
- 외래키속성의 도메인과 참조되는 기본키의 도메인은 반드시 같아야한다.    
 도메인이 같아야 연관성 있는 투플을 찾기위한 비교연산이 가능하기 때문.
- 하나의 릴레이션에 외래키가 여러개 존재할 수 도있다.
- 외래키를 기본키로 사용할 수 도있고 외래키를 포함하여 기본키를 구성할 수 도있다.
- 반드시 다른 릴레이션을 참조할 필요는 없다.
  즉 외래키로 자신이 속한 릴레이션의 기본키를 참조하도록 정의가능하다.
- 예를들어 릴레이션 [고객아이디(기본키) 추천고객(고객아이디를 참조하는 외래키)]
  
-      외래키가 대체키를 참조하는 것도 가능하다.
       기본키로 선택받지않아도 대체키는 유일성과 최소성을 만족시키기 때문이다.
       그래도 일반적으론 외래키는 기본키를 참조하는 경우가 많다.

# 02 관계 데이터 모델의 제약
관계 데이터 모델에서 정의하고 있는 기본제약사항에 대해 알아보자.
## 무결성 제약조건
- 무결성이란 데이터에 결함이 없는 상태. 즉 데이터가 정확하고 유효하게 유지되는 상태를 말한다.   
데이터베이스 상태를 일관되게 유지하는 것.
- 무결성은 보안과 유사하다.   
하지만 보안이 권한이 없는 사용자로 부터 데이터를 보호하는 것이라면,
무결성은 권한이 있는 사용자로 부터 데이터가 부정확해지는 것을 막는것.
### 1. 개체 무결성 제약조건 : 기본키는 널값을 가질 수 없다.        
기본키를 구성하는 모든 속성은 널 값을 가지면 안된다는 규칙히다.       
이는 투플의 유일성을 판단하기 위함이며, 널 값은 기본키의 본래 목적을 상실시킨다.      
### 2. 참조 무결성 제약조건 : 외래키는 첨조 할 수 없는 값을 가질 수 없다.
참조 무결성은 외래키에 대한 규칙이다.          
외래키는 참조 불가능한 값을 가질 수 없다는 규칙으로,       
외래키는 다른 릴레이션의 기본키를 참조하여 릴레이션 간의 관계를 표현하기 때문에 참조가 불가능하면 존재 의미가 없어진다.   

### 1. 외래키의 값이 기본키 릴레이션에 없는 값인 경우 (참조무결성 위반)  
**이유:**  
외래키는 참조 무결성을 보장하기 위해 기본키 릴레이션의 값을 참조해야 한다.  
- 외래키가 기본키에 없는 값을 참조하면, 해당 참조가 의미를 가지지 못하므로 데이터 일관성이 깨진다.  
- 예를 들어, 학생 테이블(Student)에 `학과번호(dept_id)`가 외래키로 설정되어 있고,        
학과 테이블(Department)에 존재하지 않는 학과번호를 참조한다면 해당 학생은 존재하지 않는 학과에 소속된 것으로 처리된다.       
이는 무결성 위반이다.


### 2. 외래키의 값이 널(NULL) 값인 경우 (참조무결성 무조건 위반이 아님)  
**이유:**  
외래키의 값이 널(NULL)일 때는 참조 무결성 규칙을 위반하지 않는 경우가 있다.      
- 외래키가 널 값인 경우, 해당 값은 특정 기본키를 참조하지 않는다는 의미로 해석될 수 있다.      
- 예를 들어, 직원 테이블(Employee)에 `관리자 ID(manager_id)`가 외래키로 설정되어 있지만, 최고 관리자(CEO)는 관리자가 없으므로 널 값이 허용된다.      
- 이처럼 널 값은 "참조할 값이 없음"을 의미하므로, 상황에 따라 참조 무결성을 위반하지 않는다.      

**결론:**  
외래키의 값이 널(NULL)일 때는 특별한 의미(참조할 값이 없음)를 가질 수 있으므로 반드시 무결성 위반으로 간주하지 않는다.    

---
- 투플을 삭제하는 연산은 참조무결성 제약조건을 위반하지 않는 경우에만 수행된다.    
- 투플을 수정하는 연산은 참조무결성 제약조건을 위반하지 않는 경우에만 수행된다. 혹은 해당 투플을 참조하는 투플을 함께 변경해야한다.      
이렇듯 데이터베이스 상태가 빈번하게 변경되는 경우, 참조 무결성 제약조건을 계속 만족시키기 쉽지않다.    
따라서 DBMS가 이를 자동으로 수행한다. 
