
# 02 데이터베이스의 구조

### 스키마
- **스키마**는 데이터 구조와 제약 조건을 정의하는 것이다. 예를 들어, 학생 테이블에 '학생ID', '이름', '학년'과 같은 필드가 포함된 구조를 정의하는 것이 스키마이다.
- 실제로 이 스키마에 맞게 저장된 객체를 **인스턴스**라고 한다. 예를 들어, 특정 학생의 정보는 '학생ID = 123', '이름 = 홍길동', '학년 = 2'와 같이 저장된 데이터 인스턴스이다.
- 스키마는 한 번 정의되면 자주 변경되지 않지만, 인스턴스는 데이터가 입력되거나 수정될 때마다 계속 변화한다.

### 3단계 데이터베이스 구조

미국의 표준화 기관인 ANSI는 데이터베이스의 내부 구조를 감추고 일반 사용자가 데이터베이스를 쉽게 이해하고 사용할 수 있도록 3단계 데이터베이스 구조를 제안했다. 이 구조는 다음과 같다:

- **외부단계** (세대주 관점): 개별 사용자가 데이터를 어떻게 볼지에 대한 관점이다.
- **개념단계** (관리인 관점): 조직 전체의 데이터를 어떻게 구성할지에 대한 관점이다.
- **내부단계** (건설업체 관점): 데이터가 실제로 저장되는 물리적 관점이다.

### 외부단계
- 외부 스키마는 개별사용자 관점에서 필요한 데이터베이스를 정의한다.     
- 외부스키마 하나를 목적이 같은 사용자들이 공유할 수 있다.    
- 전체 데이터베이스 중 사용자가 관심을 가지는 일부분을 볼 수 있어 서브스키마 라고도 한다.    

### 개념단계   
- 일반적으로 스키마라하면 개념스키마를 의미한다.    
- 일부분이 아닌 전체 데이터베이스에 관심을 둔다.          
- 관리시스템이나 관리자의 관점에서 필요한 모든 데이터를 통합하여 전체 데이터베이스의 논리적 구조를 정의한다.      
- 조직전체의 관점에서의 데이터베이스이다.        
- 제약조건 뿐 아닌, 보안정책이나 접근권한에 대한 정의도 한다. 하지만 데이터를 물리적으로 저장하는 방법이나 데이터저장 장치와는 독립적이다!        
- 하나의 데이터베이스는 개념스키마가 하나만 존재하고 각사용자는 개념스키마의 일부분을 사용한다.        
즉, 외부스키마는 개념스키마를 기초로 이용목적에 맞게 사용된다.   

## 내부단계 
- 데이터베이스를 디스크나 테이프 같은 저장장치의 관점에서 이해한다.    
- 내부 단계에선 전체 데이터베이스가 저장장치에 실제로 저장되는 법(물리적인 저장 방법에 대한 세부사항)을 정의하며 이를 내부스키마라한다.
- 예를 들어 레코드의 구조, 필드의크기 , 인덱스 설정등을 저장.

## 정리
- 외부단계에서는 사용자별로 외부 스키마를 정의하여 불필요한 데이터 접근을 막고 보안 측면에서 효과적이다.
- 개념단계에서는 데이터베이스의 논리적 구조와 제약조건을 정의하며, 조직 전체 관점에서 데이터를 통합적으로 관리한다.
- 내부단계에서는 파일의 레코드 구조와 데이터의 물리적 저장 방식을 정의한다. 예를 들어, 데이터 타입 정의, 레코드 구조 설정, 인덱스 설정 등이 포함된다.
---

### 예시

**온라인 쇼핑몰 데이터베이스**

- **외부단계 (손님 역할)**: 고객은 상품명, 가격, 배송 정보 등 쇼핑에 필요한 정보만을 확인할 수 있다. 각 고객은 자신이 관심 있는 카테고리만 볼 수 있으며, 특정 상품이나 주문 내역을 조회하는 화면이 제공된다.
- **개념단계 (프로그램에 정보 넣는 사람 역할)**: 쇼핑몰 관리자나 시스템은 전체 쇼핑몰 데이터베이스를 관리하며, 모든 상품 정보, 고객 정보, 주문 내역 등을 통합적으로 관리한다. 또한, 보안 정책과 접근 권한을 정의하여 고객과 관리자 간의 데이터 접근을 제한한다.
- **내부단계 (개발자 역할)**: 데이터는 실제로 서버에 저장되며, 상품 정보는 가격, 재고, 카테고리 등에 따라 구조화되고, 인덱스가 생성되어 빠른 검색이 가능하도록 저장된다.
---

## 데이터 독립성
세 스키마에는 유기적인 대응관계가 성립하고 이를 사상 또는 매핑이라고 한다.
- 외부스키마 - 외부/개념 사상(논리적 데이터 독립성), 응용 interface - 개념스키마 - 개념/내부 사상(물리적 데이터 독립성), 저장 interface- 내부스키마
- 논리적 데이터 독립성/ 물리적 데이터 독립성은 각각의 스키마 변경이 서로에게 영향을 주지않음을 의미한다.

## 데이터사전 (시스템 데이터베이스)
- 데이터베이스를 운영하려면 스키마와 사상정보같은 부가정보 저장도 필요하다.    
데이터에 대한 정보를 저장하는 곳을 데이터사전 혹은 시스템 카탈로그라고하고 그안의 데이터는 메타데이터, 즉 데이터의 데이터라고 불린다.
- 데이터사전도 데이터베이스의 일종이므로 시스템 데이터베이스라고도 한다.
- 이와 구분되는 실제로 이용되는 데이터가 저장되는 일반 데이터베이스를 사용자 데이터베이스라고 한다.
- 데이터 디렉토리에서 데이터사전의 데이터에 실제적으로 접속하는데 필요한 주소를 관리한다.
  둘다 시스템을 위한 데이터베이스이지만 데이터사전은 사용자 접근이 가능하지만, 데이터 디렉터리는 시스템만 접근할 수 있다는 차이가 존재한다.
---
# 03 데이터베이스 사용자
사용자는 크게 데이터베이스 관리자 / 응용프로그래머 / 일반 사용자 로 구분된다. 

## 데이터베이스 관리자 DBA 
- 데이터베이스 운영과 관리를 책임진다.
- 데이터베이스를 직접 활용하기 보단 조직내 사용자를 위해 설계 구축  
- 주로 정의어와 데이터 제어어를 이용해 데이터베이스에 접근
-     주요업무 :
      1. 데이터베이스 스키마 정의
      2. 물리적 저장구조, 접근방법결정
      3. 무결성 유지를 위한 제약조건 정의
      4. 보안 및 접근 권한 정책 결정
      5. 백업 및 회복 기법 정의
      6. 시스템 데이터베이스 관리
      7. 시스템 성능 감시 성능 분석
      8. 요구사항에 맞는 데이터베이스 재구성
## 응용 프로그래머 
- 주로 언어로(C , java등등) 프로그램을 작성하며 데이터조작어를 삽입한다.
- 최종 사용자를 위해 응용프로그래머는 작성한 응용프로그램을 이용해 데이터베이스에 접근할 수 있도록 함.
## 최종사용자
- 주로 데이터 조작어를 사용한다.
- 최종사용자는 캐주얼 사용자(데이터베이스에 이론적 지식이 있는)와 초보사용자(없는)로 구분가능.
- 일반적으로 GUI형태의 응용프로그램 사용.

---
### 04 데이터언어

데이터언어는 데이터베이스와 상호작용하기 위한 언어로, 크게 세 가지 유형으로 나뉜다:

1. **DDL (데이터 정의어)**
   - 데이터베이스의 **구조**를 정의, 수정, 삭제하는 데 사용된다.
   - 예: `CREATE`, `ALTER`, `DROP` 등
   - DDL은 **데이터 사전**에 저장되며, 데이터베이스의 **스키마**를 변경하거나 새로운 테이블을 생성하는 등의 작업을 수행한다.

2. **DML (데이터 조작어)**
   - 데이터베이스에 저장된 **데이터**를 삽입, 삭제, 수정, 검색하는 데 사용된다.
   - 절차적 DML은 데이터의 처리 방법과 과정을 사용자가 직접 정의하는 방식이다.
   - 비절차적 DML은 사용자가 원하는 결과만 정의하며, 처리 과정은 시스템이 자동으로 처리하는 방식이다.
   - 절차적 데이터 조작어는 데이터를 얻기 위한 구체적인 과정을 설명하는 방식이다. 예를 들어, `INSERT`, `UPDATE`, `DELETE`는 데이터에 대한 명확한 변경 과정을 명시한다.
   - 비절차적 데이터 조작어 (선언적 언어)는 "무엇을 원하는지"만을 정의하고, 그 과정은 시스템에 맡기는 방식이다. 예를 들어, `SELECT`는 원하는 데이터를 "선언"할 수 있다.

3. **DCL (데이터 제어어)**
   - 데이터베이스의 **보안**과 **권한 관리**를 위한 규칙이나 기법을 정의하는 언어다.
   - 예: `GRANT`, `REVOKE` 등
   - DCL은 데이터베이스의 사용자 권한을 제어하거나, 특정 작업을 수행할 수 있는 권한을 부여하거나 철회하는 데 사용된다.
   - 무결성, 보안, 회복, 동시성을 처리
  
   ---
# 05 데이터베이스 관리 시스템의 구성

데이터베이스 관리 시스템(DBMS)은 크게 **질의 처리기**(Query Processor)와 **저장 데이터 관리자**(Storage Manager)로 구분된다. 
## **1. 질의 처리기 (Query Processor)**

질의 처리기는 사용자가 작성한 쿼리를 처리하고, 이를 실행할 수 있도록 변환하는 역할을 한다.
1. **DDL 처리기** (Data Definition Language Processor)
   - DDL을 처리하여 데이터베이스의 구조를 정의하거나 수정하는 역할을 한다.
   - 예를 들어, 테이블을 생성하거나 삭제하는 `CREATE`, `ALTER`, `DROP` 명령어를 처리한다.

2. **DML 처리기** (Data Manipulation Language Processor)
   - DML을 처리하여 데이터의 삽입, 삭제, 수정, 검색을 수행한다.
   - 사용자가 요청한 데이터를 실제로 조작하는 데 필요한 SQL 명령어를 처리한다.
   - 예를 들어, `INSERT`, `UPDATE`, `DELETE`, `SELECT` 명령어가 포함된다.

3. **트랜잭션 처리기** (Transaction Processor)
   - 트랜잭션을 관리하며, 데이터베이스의 일관성과 무결성을 유지하는 역할을 한다.
   - 트랜잭션은 데이터베이스에서 처리하는 하나의 작업 단위로, 트랜잭션의 시작과 끝을 관리하고, 정상적으로 처리되었을 때만 데이터를 커밋한다.
   
4. **런타임 데이터베이스 처리기** (Runtime Database Processor)
   - 데이터베이스 시스템이 실행되는 동안 실시간으로 데이터를 처리하는 컴포넌트이다.
   - 실행 중인 쿼리를 최적화하여 빠르게 처리할 수 있도록 돕는다.
   
5. **트랜잭션 관리자** (Transaction Manager)
   - 트랜잭션의 처리 상태를 관리하며, ACID 속성(원자성, 일관성, 독립성, 지속성)을 보장한다.
   - 트랜잭션이 실패하면 롤백을 통해 이전 상태로 되돌리거나, 성공하면 커밋하여 데이터베이스에 반영한다.

---

## **2. 저장 데이터 관리자 (Storage Manager)**

저장 데이터 관리자는 실제로 디스크에 데이터를 저장하고 관리하는 역할을 담당한다. 이 관리자 없이 데이터의 물리적 저장이나 접근이 불가능하다.

- **디스크 저장 관리** (Disk Storage Management)
  - 데이터베이스 파일을 물리적으로 디스크에 저장하고, 파일 시스템을 관리하는 역할을 한다.
  - 이 시스템은 운영체제의 파일 관리 기능을 이용하여 데이터를 디스크에 저장하거나 불러오는 작업을 수행한다.

- **버퍼 관리** (Buffer Management)
  - 디스크에서 데이터를 읽어올 때 사용하는 임시 저장 공간인 버퍼를 관리한다.
  - 자주 접근되는 데이터를 메모리에 미리 로드하여 데이터베이스의 성능을 향상시킨다.

- **데이터 사전 관리** (Data Dictionary Management)
  - 데이터베이스의 구조적 정보를 저장하는 데이터 사전(메타데이터)을 관리한다.
  - 데이터 사전에는 테이블, 컬럼, 제약조건, 인덱스 등 데이터베이스에 대한 정의가 포함된다.

- **디스크 접근** (Disk Access)
  - 저장된 데이터에 물리적으로 접근하는 과정으로, 운영체제의 파일 시스템 기능을 사용하여 데이터베이스의 데이터를 처리한다.
  - 디스크에서 데이터를 읽고 쓰는 작업은 운영체제의 도움을 받아 처리된다.

## 정리

- **질의 처리기**는 사용자가 요청한 쿼리를 처리하고, 데이터 조작 및 정의, 트랜잭션 관리 등을 담당한다.
- **저장 데이터 관리자**는 데이터를 디스크에 저장하고 관리하며, 물리적 데이터 접근을 담당한다. 또한, 운영체제의 기능을 이용하여 디스크에 데이터를 저장하고 읽어오는 작업을 수행한다.
