# SQL 소개

SQL은 데이터베이스를 관리하고 조작하기 위해 가장 널리 사용되는 표준 질의어이며, 비절차적 데이터 언어이다.

데이터베이스 시스템 간의 호환성을 위해 ANSI와 국제표준화기구 ISO에서 SQL을 표준 질의어로 채택하고 표준화를 진행했다.

---

## SQL 분류

1. **데이터 정의어 (DDL)**

   - 테이블을 생성, 변경, 삭제하는 기능을 담당한다. 대표적으로 `CREATE`, `ALTER`, `DROP` 명령어가 있다.

2. **데이터 조작어 (DML)**

   - 테이블의 데이터를 삽입, 조회, 수정, 삭제하는 기능을 제공한다. 대표적으로 `SELECT`, `INSERT`, `UPDATE`, `DELETE` 명령어가 있다.

3. **데이터 제어어 (DCL)**

   - 데이터베이스 보안을 위해 사용자별 권한을 부여하거나 회수하며, 주로 데이터베이스 관리자가 사용한다. 대표적으로 `GRANT`, `REVOKE` 명령어가 있다.

---

## SQL을 이용한 데이터 정의

`CREATE TABLE` 문은 테이블의 속성 이름, 데이터 타입, 제약 사항, 기본키/대체키/외래키의 정의, 데이터 무결성을 위한 제약 조건 등을 설정할 수 있다.

### 주요 사항

- **기본키**: 테이블당 하나만 설정할 수 있으며, 기본적으로 `NOT NULL` 특성을 가진다.
- **외래키**: 테이블에 여러 개 존재할 수 있다.
- **세미콜론(;)**: SQL 문장의 끝을 표시한다. 대부분의 SQL 인터페이스에서 관행적으로 사용된다.

  (일반적인 상황에서는 한 문장만 실행하면 세미콜론이 필수는 아니지만, 대부분의 SQL에서  관행적으로 사용)

**대소문자**: SQL 키워드는 대소문자를 구분하지 않는다.

### 오라클 데이터 타입

- `VARCHAR2`: 오라클에서 `VARCHAR`보다 성능이 개선된 데이터 타입으로 더 많이 사용된다.
- `NUMBER`: `NUMERIC`, `DECIMAL` 대신 사용된다.
- `DATE`: 날짜와 시간을 표현하며, `DATETIME`은 지원하지 않는다.

### 속성 관련 주요 사항

- 기본적으로 **NULL 값**이 허용된다. 기본값을 설정하지 않으면 NULL이 기본이다.
- `DEFAULT` 키워드로 기본값을 설정할 수 있다. 이때:
  - 숫자는 그대로 표기한다.
  - 문자열이나 시간 값은 작은따옴표(`'`)로 묶는다.
  - 문자열은 **대소문자를 구분**한다.

### 키의 정의

- **기본키 (PRIMARY KEY)**

  - `PRIMARY KEY` 키워드로 지정한다.
  - 여러 속성으로 구성된 복합 기본키도 가능하다.

- **대체키 (UNIQUE)**

  - `UNIQUE` 키워드로 지정한다.
  - 기본키와 마찬가지로 튜플을 유일하게 식별하며, 테이블 내에서 중복이 허용되지 않는다.
  - 대체키는 한 테이블에 여러 개 지정할 수 있다.

- **외래키 (FOREIGN KEY)**

  - `FOREIGN KEY` 키워드로 지정하며, `REFERENCES` 키워드로 참조하는 속성을 명시한다.
  - 참조 무결성을 위해 참조되는 테이블의 튜플이 함부로 삭제되거나 변경되지 않도록 제한할 수 있다.

#### 외래키와 참조 동작

- **참조하는 테이블** (외래키):

  - `ON DELETE NO ACTION` (기본값): 참조되는 튜플 삭제 금지
  - `ON DELETE CASCADE`: 참조되는 튜플과 함께 삭제
  - `ON DELETE SET NULL`: 외래키 값을 NULL로 설정 후 삭제
  - `ON DELETE SET DEFAULT`: 외래키 값을 기본값으로 설정 후 삭제

- **참조되는 테이블** (기본키):

  - `ON UPDATE NO ACTION` (기본값): 참조되는 튜플 변경 금지
  - `ON UPDATE CASCADE`: 참조하는 튜플도 함께 변경
  - `ON UPDATE SET NULL`: 참조하는 외래키 값을 NULL로 변경
  - `ON UPDATE SET DEFAULT`: 참조하는 외래키 값을 기본값으로 변경

### 데이터 무결성 제약 조건

- **`CHECK`**\*\* 키워드\*\*로 제약 조건을 정의한다.

  - 테이블에서 항상 정확하고 유효한 데이터를 유지하기 위해 사용된다.
  - 예: `CHECK (재고량 >= 0 AND 재고량 <= 1000)`

- **`CONSTRAINT`**\*\* 키워드\*\*로 제약 조건에 고유 이름을 부여할 수 있다.

  - 예: `CONSTRAINT CHK_CPY CHECK (제조업체 = '한빛제과')`

---

## 테이블 변경 및 삭제

### 테이블 변경 (`ALTER TABLE`)

- 새로운 속성 추가: `ALTER TABLE 테이블명 ADD (속성이름 데이터타입);`
- 기존 속성 삭제: `ALTER TABLE 테이블명 DROP COLUMN 속성이름;`
  - 삭제할 속성과 관련된 제약 조건이나 참조하는 속성이 있다면 먼저 삭제해야 한다.
- 새로운 제약 조건 추가: `ALTER TABLE 테이블명 ADD CONSTRAINT 제약조건명 제약조건;`
- 기존 제약 조건 삭제: `ALTER TABLE 테이블명 DROP CONSTRAINT 제약조건명;`

### 테이블 삭제 (`DROP TABLE`)

- 테이블 삭제: `DROP TABLE 테이블명;`
- 오라클에서는 `CASCADE CONSTRAINT` 옵션으로 관련 외래키 제약 조건도 함께 삭제할 수 있다.
  - 그렇지 않다면 삭제하려는 테이블을 참조하는 외래키 제약 조건을 먼저 삭제해야 한다.


# 03 SQL 을 이용한 데이터 조작
- SELETE 문은 동일 한 투플이 중복가능하다.   
이러한 중복을 허용하도록 ALL 키워드도 명시할 수 있다.
- DISTINCT 키워드를 사용하여 중복 제거도 가능하다. 
- AS로 별칭을 만들수 있다. (AS는 생략가능)     
공백이 포함되면 오라클은 큰따옴표로 묶어주고 MSSQL은 작은따옴표로 묶어줘야한다.
     
